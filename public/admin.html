<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minilatics - Analytics</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #000;
            color: #fff;
            line-height: 1.6;
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 300;
            margin-bottom: 2rem;
            color: #fff;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: #111;
            border: 1px solid #333;
            padding: 1.5rem;
            border-radius: 8px;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 600;
            color: #fff;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .section {
            margin-bottom: 3rem;
        }

        .section h2 {
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 1rem;
            color: #fff;
        }

        .list {
            background: #111;
            border: 1px solid #333;
            border-radius: 8px;
            overflow: hidden;
        }

        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #222;
        }

        .list-item:last-child {
            border-bottom: none;
        }

        .list-item-main {
            color: #fff;
            font-weight: 400;
        }

        .list-item-count {
            color: #999;
            font-size: 0.9rem;
        }

        .loading {
            text-align: center;
            color: #666;
            font-size: 0.9rem;
            padding: 2rem;
        }

        .error {
            background: #111;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1.5rem;
            color: #ff6b6b;
            text-align: center;
        }

        .period-selector {
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .period-selector select {
            background: #111;
            border: 1px solid #333;
            color: #fff;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-family: inherit;
        }

        .period-selector select:focus {
            outline: none;
            border-color: #666;
        }

        #active-users-text {
            background: #111;
            border: 1px solid #333;
            border-radius: 4px;
            padding: 0.5rem 1rem;
            color: #999;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        #active-users {
            color: #fff;
            font-weight: 500;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            display: inline-block;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 1;
                box-shadow: 0 0 0 0 rgba(74, 222, 128, 0.7);
            }
            70% {
                opacity: 1;
                box-shadow: 0 0 0 10px rgba(74, 222, 128, 0);
            }
            100% {
                opacity: 1;
                box-shadow: 0 0 0 0 rgba(74, 222, 128, 0);
            }
        }

        .copy-link {
            background: #111;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .copy-link h3 {
            font-size: 1rem;
            font-weight: 500;
            margin-bottom: 1rem;
            color: #fff;
        }

        .copy-link p {
            color: #999;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .copy-link code {
            background: #000;
            border: 1px solid #333;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.8rem;
            color: #fff;
            display: block;
            word-break: break-all;
        }

        .chart-container {
            background: #111;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 3rem;
            overflow: hidden;
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 2rem;
            color: #fff;
            text-align: center;
        }

        .chart-svg {
            width: 100%;
            height: 300px;
            overflow: visible;
        }

        .chart-line {
            fill: none;
            stroke: #fff;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            filter: url(#roughPaper);
        }

        .chart-area {
            fill: url(#gradient);
            opacity: 0.1;
        }

        .chart-dot {
            fill: #fff;
            stroke: #111;
            stroke-width: 3;
            r: 4;
        }

        .chart-dot:hover {
            r: 6;
            stroke-width: 2;
        }

        .chart-axis {
            stroke: #333;
            stroke-width: 1;
        }

        .chart-grid {
            stroke: #222;
            stroke-width: 0.5;
            stroke-dasharray: 2,2;
        }

        .chart-label {
            fill: #999;
            font-size: 0.75rem;
            font-family: 'Inter', sans-serif;
        }

        .chart-tooltip {
            background: #000;
            border: 1px solid #333;
            border-radius: 4px;
            padding: 0.5rem;
            color: #fff;
            font-size: 0.8rem;
            position: absolute;
            pointer-events: none;
            z-index: 1000;
            display: none;
        }

        .setup-container {
            background: #111;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .setup-title {
            font-size: 1.5rem;
            font-weight: 500;
            margin-bottom: 1rem;
            color: #fff;
        }

        .setup-description {
            color: #999;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .script-display {
            background: #000;
            border: 1px solid #333;
            padding: 1rem;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.8rem;
            color: #fff;
            margin-bottom: 2rem;
            word-break: break-all;
        }

        .verify-button {
            background: #fff;
            color: #000;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 4px;
            font-family: inherit;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .verify-button:hover {
            background: #e0e0e0;
        }

        .verify-button:disabled {
            background: #333;
            color: #666;
            cursor: not-allowed;
        }

        .verification-status {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .verification-success {
            background: #1a4d3a;
            color: #4ade80;
            border: 1px solid #16a34a;
        }

        .verification-error {
            background: #4d1a1a;
            color: #f87171;
            border: 1px solid #dc2626;
        }

        .verification-waiting {
            background: #2d2d1a;
            color: #fbbf24;
            border: 1px solid #f59e0b;
        }

        .toggle-line {
            position: relative;
            margin: 2rem 0;
            cursor: pointer;
            user-select: none;
        }

        .section-divider {
            border: none;
            height: 1px;
            background: #333;
            margin: 0;
        }

        .toggle-text {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            background: #000;
            color: #999;
            padding: 0 1rem;
            font-size: 0.9rem;
            transition: color 0.2s ease;
        }

        .toggle-line:hover .toggle-text {
            color: #fff;
        }

        .toggle-line:hover .section-divider {
            background: #666;
        }

        .details-sections {
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease;
        }

        .details-sections.collapsed {
            max-height: 0;
            opacity: 0;
        }

        .details-sections.expanded {
            max-height: 1000px;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Minilatics</h1>
        
        <div id="setup-screen">
            <div class="setup-container">
                <div class="setup-title">🚀 Get Started</div>
                <div class="setup-description">
                    Add this one line to your website to start tracking analytics:
                </div>
                <div class="script-display" id="script-code"></div>
                <button class="verify-button" id="verify-button" onclick="verifyTracking()">
                    Verify Tracking Script
                </button>
                <div id="verification-status" style="display: none;"></div>
            </div>
        </div>

        <div id="analytics-screen" style="display: none;">
            <div class="period-selector">
                <span id="active-users-text">
                    <span class="live-dot"></span>
                    Active Users: <span id="active-users">0</span>
                </span>
                <select id="period-select" onchange="loadStats()">
                    <option value="7">Last 7 days</option>
                    <option value="30" selected>Last 30 days</option>
                    <option value="90">Last 90 days</option>
                </select>
            </div>

            <div id="loading" class="loading">Loading analytics...</div>
            <div id="error" class="error" style="display: none;"></div>
        
        <div id="stats" style="display: none;">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-views">0</div>
                    <div class="stat-label">Page Views</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="unique-visitors">0</div>
                    <div class="stat-label">Unique Visitors</div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">Page Views Over Time</div>
                <svg class="chart-svg" id="pageViewsChart">
                    <defs>
                        <filter id="roughPaper" x="0%" y="0%" width="100%" height="100%">
                            <feTurbulence baseFrequency="0.04" numOctaves="3" result="noise"/>
                            <feDisplacementMap in="SourceGraphic" in2="noise" scale="1"/>
                        </filter>
                        <linearGradient id="gradient" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#fff;stop-opacity:0.3" />
                            <stop offset="100%" style="stop-color:#fff;stop-opacity:0" />
                        </linearGradient>
                    </defs>
                </svg>
                <div class="chart-tooltip" id="tooltip"></div>
            </div>

            <div class="toggle-line" id="toggle-details" onclick="toggleDetails()">
                <hr class="section-divider">
                <span class="toggle-text">Show More Details</span>
            </div>

            <div class="details-sections collapsed" id="details-sections">
                <div class="section">
                    <h2>Top Pages</h2>
                    <div class="list" id="top-pages">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>

                <div class="section">
                    <h2>Top Referrers</h2>
                    <div class="list" id="top-referrers">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        console.log('Script started loading...');
        
        const siteKey = window.location.pathname.split('/')[2] || 'your-site-key';
        const baseUrl = window.location.origin;
        
        console.log('Variables initialized:', { siteKey, baseUrl });
        
        // Set the tracking script code
        try {
            document.getElementById('script-code').textContent = '<script src="' + baseUrl + '/script.js" data-site-key="' + siteKey + '"><\/script>';
        } catch (error) {
            console.error('Error setting script content:', error);
        }

        // Check if tracking has been verified (stored in localStorage)
        const isTrackingVerified = localStorage.getItem(`tracking_verified_${siteKey}`) === 'true';
        
        if (isTrackingVerified) {
            showAnalytics();
        }

        // Debug: Log that functions are loaded
        console.log('Functions loaded:', {
            verifyTracking: typeof verifyTracking,
            loadStats: typeof loadStats,
            showAnalytics: typeof showAnalytics
        });

        // Function to format referrer names
        function formatReferrer(referrer) {
            if (!referrer || referrer === '' || referrer === 'null' || referrer === 'undefined') {
                return 'Direct';
            }
            
            // Handle Google searches
            if (referrer.includes('google.com') || referrer.includes('google.') || referrer.includes('www.google')) {
                return 'Google (Organic Search)';
            }
            
            // Handle other search engines
            if (referrer.includes('bing.com') || referrer.includes('bing.')) {
                return 'Bing (Organic Search)';
            }
            if (referrer.includes('yahoo.com') || referrer.includes('yahoo.')) {
                return 'Yahoo (Organic Search)';
            }
            if (referrer.includes('duckduckgo.com')) {
                return 'DuckDuckGo (Organic Search)';
            }
            
            // Handle social media
            if (referrer.includes('facebook.com') || referrer.includes('fb.com')) {
                return 'Facebook';
            }
            if (referrer.includes('twitter.com') || referrer.includes('t.co')) {
                return 'Twitter/X';
            }
            if (referrer.includes('linkedin.com')) {
                return 'LinkedIn';
            }
            if (referrer.includes('instagram.com')) {
                return 'Instagram';
            }
            
            // For other referrers, try to extract the domain name
            try {
                const url = new URL(referrer.startsWith('http') ? referrer : 'https://' + referrer);
                return url.hostname.replace('www.', '');
            } catch {
                return referrer;
            }
        }

        function showSetupScreen() {
            document.getElementById('setup-screen').style.display = 'block';
            document.getElementById('analytics-screen').style.display = 'none';
        }

        function showAnalytics() {
            document.getElementById('setup-screen').style.display = 'none';
            document.getElementById('analytics-screen').style.display = 'block';
            loadStats();
        }

        async function verifyTracking() {
            const button = document.getElementById('verify-button');
            const statusEl = document.getElementById('verification-status');
            
            // Show waiting status
            button.disabled = true;
            button.textContent = 'Verifying...';
            statusEl.style.display = 'block';
            statusEl.className = 'verification-status verification-waiting';
            statusEl.innerHTML = '⏳ Checking for tracking data...';

            try {
                // Check if there's any data for this site key
                const response = await fetch(`${baseUrl}/stats/${siteKey}?days=1`);
                const data = await response.json();

                if (response.ok && data.total_views > 0) {
                    // Success - tracking is working
                    statusEl.className = 'verification-status verification-success';
                    statusEl.innerHTML = '✅ Tracking script verified! Found ' + data.total_views + ' page views.';
                    
                    // Store verification in localStorage
                    localStorage.setItem(`tracking_verified_${siteKey}`, 'true');
                    
                    // Switch to analytics after a short delay
                    setTimeout(() => {
                        showAnalytics();
                    }, 2000);
                    
                } else {
                    // No data found
                    statusEl.className = 'verification-status verification-error';
                    statusEl.innerHTML = '❌ No tracking data found. Make sure you\'ve added the script to your website and visited at least one page.';
                    button.disabled = false;
                    button.textContent = 'Verify Tracking Script';
                }
            } catch (error) {
                // Network or other error
                statusEl.className = 'verification-status verification-error';
                statusEl.innerHTML = '❌ Verification failed. Please check your connection and try again.';
                button.disabled = false;
                button.textContent = 'Verify Tracking Script';
            }
        }

        // Add a reset function for testing
        function resetVerification() {
            localStorage.removeItem(`tracking_verified_${siteKey}`);
            showSetupScreen();
        }

        // Add keyboard shortcut for reset (Ctrl+Shift+R)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'R') {
                resetVerification();
            }
        });

        async function loadStats() {
            const days = document.getElementById('period-select').value;
            const loadingEl = document.getElementById('loading');
            const errorEl = document.getElementById('error');
            const statsEl = document.getElementById('stats');

            console.log(`Loading stats for ${siteKey} (${days} days) from ${baseUrl}`);
            
            loadingEl.style.display = 'block';
            errorEl.style.display = 'none';
            statsEl.style.display = 'none';

            try {
                const response = await fetch(`${baseUrl}/stats/${siteKey}?days=${days}`);
                const data = await response.json();
                
                console.log('Received analytics data:', data);

                if (!response.ok) {
                    throw new Error(data.error || 'Failed to load stats');
                }

                // Update stats
                document.getElementById('total-views').textContent = data.total_views.toLocaleString();
                document.getElementById('unique-visitors').textContent = data.unique_visitors.toLocaleString();
                document.getElementById('active-users').textContent = (data.active_users || data.unique_visitors || 0).toLocaleString();

                // Update top pages
                const pagesEl = document.getElementById('top-pages');
                pagesEl.innerHTML = '';
                data.top_pages.forEach(page => {
                    const item = document.createElement('div');
                    item.className = 'list-item';
                    item.innerHTML = `
                        <div class="list-item-main">${page.page_path}</div>
                        <div class="list-item-count">${page.views} views</div>
                    `;
                    pagesEl.appendChild(item);
                });

                // Update top referrers
                const referrersEl = document.getElementById('top-referrers');
                referrersEl.innerHTML = '';
                if (data.top_referrers.length === 0) {
                    const item = document.createElement('div');
                    item.className = 'list-item';
                    item.innerHTML = `
                        <div class="list-item-main">Direct</div>
                        <div class="list-item-count">No referrer data</div>
                    `;
                    referrersEl.appendChild(item);
                } else {
                    data.top_referrers.forEach(referrer => {
                        const item = document.createElement('div');
                        item.className = 'list-item';
                        const formattedReferrer = formatReferrer(referrer.referrer);
                        item.innerHTML = `
                            <div class="list-item-main">${formattedReferrer}</div>
                            <div class="list-item-count">${referrer.visits} visits</div>
                        `;
                        referrersEl.appendChild(item);
                    });
                }

                // Render the chart
                renderPageViewsChart(data.daily_views, days);

                loadingEl.style.display = 'none';
                statsEl.style.display = 'block';

            } catch (error) {
                loadingEl.style.display = 'none';
                errorEl.style.display = 'block';
                errorEl.textContent = error.message;
            }
        }

        function renderPageViewsChart(dailyViews, days) {
            const svg = document.getElementById('pageViewsChart');
            const tooltip = document.getElementById('tooltip');
            
            // Clear previous chart
            while (svg.children.length > 1) {
                svg.removeChild(svg.lastChild);
            }

            const margin = { top: 20, right: 30, bottom: 40, left: 50 };
            const width = 700 - margin.left - margin.right;
            const height = 260 - margin.top - margin.bottom;

            // Fill in missing days with 0 views
            const allDays = [];
            const endDate = new Date();
            
            for (let i = parseInt(days) - 1; i >= 0; i--) {
                const date = new Date(endDate);
                date.setDate(date.getDate() - i);
                // Use local date instead of UTC to avoid timezone issues
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                const dateStr = `${year}-${month}-${day}`;
                const existingDay = dailyViews.find(d => d.date === dateStr);
                allDays.push({
                    date: dateStr,
                    views: existingDay ? existingDay.views : 0
                });
            }

            const maxViews = Math.max(...allDays.map(d => d.views), 1);
            
            // Create scales
            const xScale = (i) => margin.left + (i / (allDays.length - 1)) * width;
            const yScale = (value) => margin.top + height - (value / maxViews) * height;

            // Create main group
            const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            svg.appendChild(g);

            // Draw grid lines
            for (let i = 0; i <= 5; i++) {
                const y = margin.top + (height / 5) * i;
                const gridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                gridLine.setAttribute('x1', margin.left);
                gridLine.setAttribute('x2', margin.left + width);
                gridLine.setAttribute('y1', y);
                gridLine.setAttribute('y2', y);
                gridLine.setAttribute('class', 'chart-grid');
                g.appendChild(gridLine);
            }

            // Draw axes
            const xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            xAxis.setAttribute('x1', margin.left);
            xAxis.setAttribute('x2', margin.left + width);
            xAxis.setAttribute('y1', margin.top + height);
            xAxis.setAttribute('y2', margin.top + height);
            xAxis.setAttribute('class', 'chart-axis');
            g.appendChild(xAxis);

            const yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            yAxis.setAttribute('x1', margin.left);
            yAxis.setAttribute('x2', margin.left);
            yAxis.setAttribute('y1', margin.top);
            yAxis.setAttribute('y2', margin.top + height);
            yAxis.setAttribute('class', 'chart-axis');
            g.appendChild(yAxis);

            // Create path for area fill
            let areaPath = `M ${margin.left} ${margin.top + height}`;
            allDays.forEach((d, i) => {
                const x = xScale(i);
                const y = yScale(d.views);
                if (i === 0) {
                    areaPath += ` L ${x} ${y}`;
                } else {
                    areaPath += ` L ${x} ${y}`;
                }
            });
            areaPath += ` L ${margin.left + width} ${margin.top + height} Z`;

            const area = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            area.setAttribute('d', areaPath);
            area.setAttribute('class', 'chart-area');
            g.appendChild(area);

            // Create hand-drawn line path with slight irregularities
            let linePath = '';
            allDays.forEach((d, i) => {
                const x = xScale(i) + (Math.random() - 0.5) * 2; // Add slight randomness
                const y = yScale(d.views) + (Math.random() - 0.5) * 2;
                
                if (i === 0) {
                    linePath += `M ${x} ${y}`;
                } else {
                    // Use quadratic curves for smoother hand-drawn look
                    const prevX = xScale(i - 1) + (Math.random() - 0.5) * 2;
                    const prevY = yScale(allDays[i - 1].views) + (Math.random() - 0.5) * 2;
                    const midX = (prevX + x) / 2;
                    const midY = (prevY + y) / 2;
                    linePath += ` Q ${midX + (Math.random() - 0.5) * 4} ${midY + (Math.random() - 0.5) * 4} ${x} ${y}`;
                }
            });

            const line = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            line.setAttribute('d', linePath);
            line.setAttribute('class', 'chart-line');
            g.appendChild(line);

            // Add data points
            allDays.forEach((d, i) => {
                const x = xScale(i);
                const y = yScale(d.views);
                
                const dot = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                dot.setAttribute('cx', x);
                dot.setAttribute('cy', y);
                dot.setAttribute('class', 'chart-dot');
                
                // Add hover effects
                dot.addEventListener('mouseenter', (e) => {
                    const date = new Date(d.date).toLocaleDateString();
                    tooltip.innerHTML = `${date}<br/>${d.views} views`;
                    tooltip.style.display = 'block';
                    tooltip.style.left = (e.pageX + 10) + 'px';
                    tooltip.style.top = (e.pageY - 10) + 'px';
                });
                
                dot.addEventListener('mouseleave', () => {
                    tooltip.style.display = 'none';
                });
                
                g.appendChild(dot);
            });

            // Add Y-axis labels
            for (let i = 0; i <= 5; i++) {
                const value = Math.round((maxViews / 5) * (5 - i));
                const y = margin.top + (height / 5) * i;
                
                const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                label.setAttribute('x', margin.left - 10);
                label.setAttribute('y', y + 4);
                label.setAttribute('text-anchor', 'end');
                label.setAttribute('class', 'chart-label');
                label.textContent = value;
                g.appendChild(label);
            }

            // Add X-axis labels (show every few days)
            const labelInterval = Math.max(1, Math.floor(allDays.length / 6));
            allDays.forEach((d, i) => {
                if (i % labelInterval === 0 || i === allDays.length - 1) {
                    const x = xScale(i);
                    const date = new Date(d.date);
                    const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    label.setAttribute('x', x);
                    label.setAttribute('y', margin.top + height + 20);
                    label.setAttribute('text-anchor', 'middle');
                    label.setAttribute('class', 'chart-label');
                    label.textContent = `${date.getMonth() + 1}/${date.getDate()}`;
                    g.appendChild(label);
                }
            });

            // Set SVG viewBox for responsiveness
            svg.setAttribute('viewBox', '0 0 700 300');
        }

        // Don't auto-load stats anymore - only load after verification
        
        function toggleDetails() {
            const detailsSection = document.getElementById('details-sections');
            const toggleText = document.querySelector('.toggle-text');
            
            if (detailsSection.classList.contains('collapsed')) {
                detailsSection.classList.remove('collapsed');
                detailsSection.classList.add('expanded');
                toggleText.textContent = 'Hide Details';
            } else {
                detailsSection.classList.remove('expanded');
                detailsSection.classList.add('collapsed');
                toggleText.textContent = 'Show More Details';
            }
        }
        
        console.log('Script loaded completely!');
    </script>
</body>
</html>